{% macro render_simulation_table(titulo, tabela, resumo) %}
<hr class="divider" />
<div class="resultado-header">
  <h3>{{ titulo }}</h3>
</div>

<div class="resumo-grid">
  <div class="resumo-card">
    <small>Capital Inicial</small>
    <span>R$ {{ resumo.capital_inicial }}</span>
  </div>
  <div class="resumo-card">
    <small>Juros Totais</small>
    <span class="destaque-juros">R$ {{ resumo.juros_totais }}</span>
  </div>
  <div class="resumo-card">
    <small>Montante Final</small>
    <span class="destaque-montante">R$ {{ resumo.montante }}</span>
  </div>
  <div class="resumo-card">
    <small>Taxa / Prazo</small>
    <span>{{ resumo.taxa_juros }}% / {{ resumo.prazo }} meses</span>
  </div>
</div>

<div class="tabela-container">
  <table class="simulacao-table">
    <thead>
      <tr>
        <th>Mês</th>
        <th>Amortização</th>
        <th>Juros</th>
        <th>Prestação</th>
        <th>Saldo Devedor</th>
      </tr>
    </thead>
    <tbody>
      {% for linha in tabela %}
      <tr>
        <td>{{ linha.mes }}</td>
        <td>R$ {{ linha.amortizacao }}</td>
        <td>R$ {{ linha.juros }}</td>
        <td>R$ {{ linha.prestacao }}</td>
        <td>R$ {{ linha.saldo_devedor }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<style>
  .divider { margin: 40px 0; border: 0; border-top: 1px solid #eee; }
  
  .resultado-header h3 {
    text-align: center;
    color: #333;
    margin-bottom: 25px;
  }

  /* Grid de Resumo Estilo Dashboard */
  .resumo-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: 15px;
    margin-bottom: 30px;
  }

  .resumo-card {
    background: #fff;
    padding: 15px;
    border-radius: 8px;
    border: 1px solid #eee;
    display: flex;
    flex-direction: column;
    box-shadow: 0 2px 5px rgba(0,0,0,0.05);
  }

  /* LIMITADOR DA TABELA */
  .tabela-container-scroll {
    max-height: 400px; /* Define o limite de altura da tabela */
    overflow-y: auto;  /* Scroll vertical */
    overflow-x: auto;  /* Scroll horizontal para telas pequenas */
    border: 1px solid #eee;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
  }

  .resumo-card small {
    color: #888;
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 5px;
  }

  .resumo-card span {
    font-size: 16px;
    font-weight: 600;
    color: #2c3e50;
  }

  .destaque-juros { color: #e74c3c !important; }
  .destaque-montante { color: #28a745 !important; }

  /* Tabela Minimalista */
  .tabela-container {
    overflow-x: auto;
    background: #fff;
    border-radius: 10px;
    border: 1px solid #eee;
    box-shadow: 0 4px 15px rgba(0,0,0,0.05);
    max-height: 120vh;
    overflow-y: auto;
  }

  .simulacao-table {
    width: 100%;
    border-collapse: collapse;
    min-width: 600px;
  }

  .simulacao-table th {
    background: #f8f9fa;
    color: #555;
    font-weight: 600;
    padding: 15px 12px;
    text-align: left;
    border-bottom: 2px solid #eee;
    font-size: 13px;
  }

  .simulacao-table td {
    padding: 12px;
    border-bottom: 1px solid #f1f1f1;
    font-size: 14px;
    color: #444;
  }

  .simulacao-table tr:last-child td { border-bottom: none; }
  .simulacao-table tr:hover { background-color: #fcfcfc; }

  /* Estilo para valores monetários dentro da tabela */
  .simulacao-table td:not(:first-child) {
    font-family: 'Courier New', Courier, monospace; /* Opcional: para alinhar números */
    font-weight: 500;
  }

  @media print {
    .tabela-container {
      max-height: none !important;
      overflow: visible !important;
      border: none !important;
    }
    
    .simulacao-table {
      page-break-inside: auto;
    }
    
    .simulacao-table tr {
      page-break-inside: avoid;
      page-break-after: auto;
    }
    
    .simulacao-table th {
      background-color: #f8f9fa !important;
      -webkit-print-color-adjust: exact; /* Garante que o fundo cinza do topo apareça */
    }
    
    .sidebar, .nav-bar, .footer {
      display: none !important;
    }
  }
</style>
{% endmacro %}
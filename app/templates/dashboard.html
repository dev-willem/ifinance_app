{% extends "base_authenticated.html" %} 
{% block title %}Dashboard - IFinance{% endblock %} 

{% block main_content %}
<div class="container">
  <div class="tabs">
    <button onclick="showForm('sac')" class="tab-btn active">SAC</button>
    <button onclick="showForm('price')" class="tab-btn">PRICE</button>
    <button onclick="showForm('credito')" class="tab-btn">Cr√©dito</button>
    <button onclick="showForm('lucro')" class="tab-btn">Lucro</button>
    <button onclick="showForm('cet')" class="tab-btn">CET</button>
  </div>

  <div id="infoModal" class="modal hidden">
    <div class="modal-content">
      <span class="close-modal" onclick="closeModal()">&times;</span>
      <h3 id="modalTitle">T√≠tulo</h3>
      <p id="modalDescription">Descri√ß√£o</p>
      <div class="curiosity-box">
        <strong>üí° Curiosidade:</strong>
        <p id="modalCuriosity">Curiosidade aqui...</p>
      </div>
    </div>
  </div>

  <div id="sac" class="form-section">
    <span class="info-trigger" onclick="openModal('sac')">?</span>
    {% include "forms_templates/sac.html" %}
  </div>

  <div id="price" class="form-section hidden">
    <span class="info-trigger" onclick="openModal('price')">?</span>
    {% include "forms_templates/price.html" %}
  </div>

  <div id="credito" class="form-section hidden">
    <span class="info-trigger" onclick="openModal('credito')">?</span>
    {% include "forms_templates/credito.html" %}
  </div>

  <div id="lucro" class="form-section hidden">
    <span class="info-trigger" onclick="openModal('lucro')">?</span>
    {% include "forms_templates/lucro.html" %}
  </div>

  <div id="cet" class="form-section hidden">
    <span class="info-trigger" onclick="openModal('cet')">?</span>
    {% include "forms_templates/cet.html" %}
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
  // Dados e fun√ß√µes JavaScript mantidos conforme sua estrutura
  const infoData = {
    sac: {
      title: "Sistema de Amortiza√ß√£o Constante (SAC)",
      desc: "No SAC, as parcelas diminuem ao longo do tempo porque a amortiza√ß√£o da d√≠vida √© fixa, reduzindo a base de c√°lculo dos juros mensalmente.",
      curiosity: "√â o sistema mais utilizado em financiamentos imobili√°rios de longo prazo no Brasil."
    },
    price: {
      title: "Tabela PRICE",
      desc: "Mant√©m as presta√ß√µes fixas do in√≠cio ao fim do contrato. Ideal para previsibilidade or√ßament√°ria.",
      curiosity: "No in√≠cio, a maior parte da parcela √© composta por juros, n√£o amortiza√ß√£o."
    },
    credito: {
      title: "C√°lculo de Cr√©dito",
      desc: "Simula√ß√£o de empr√©stimos baseada em taxas de juros compostos.",
      curiosity: "O custo final pode variar drasticamente dependendo do prazo escolhido."
    },
    lucro: {
      title: "Margem de Lucro",
      desc: "Calcula o retorno real ap√≥s descontar custos fixos e vari√°veis.",
      curiosity: "√â fundamental para entender a viabilidade do neg√≥cio al√©m do faturamento bruto."
    },
    cet: {
      title: "Custo Efetivo Total (CET)",
      desc: "√â a taxa real anual, incluindo juros, impostos (IOF) e tarifas banc√°rias.",
      curiosity: "Sempre use o CET para comparar qual banco realmente tem o cr√©dito mais barato."
    }
  };

  function showForm(id) {
    document.querySelectorAll(".tab-btn").forEach((btn) => btn.classList.remove("active"));
    document.querySelectorAll(".form-section").forEach((f) => f.classList.add("hidden"));
    document.getElementById(id).classList.remove("hidden");
    event.currentTarget.classList.add("active");
  }

function openModal(type) {
  const data = infoData[type];
  document.getElementById('modalTitle').innerText = data.title;
  document.getElementById('modalDescription').innerText = data.desc;
  document.getElementById('modalCuriosity').innerText = data.curiosity;
  
  const modal = document.getElementById('infoModal');
  modal.classList.remove('hidden'); // Remove o !important do CSS
  modal.style.display = 'flex';     // Garante o alinhamento central
}

function closeModal() {
  const modal = document.getElementById('infoModal');
  modal.style.display = 'none';
  modal.classList.add('hidden');
}

// Fechar ao clicar fora do conte√∫do branco
window.onclick = function(event) {
  const modal = document.getElementById('infoModal');
  if (event.target === modal) {
    closeModal();
  }
}
</script>
{% endblock %}

{% block extra_css %} 
{{ super() }}
<style>
  /* Container e Tabs */
  .container { padding: 20px; max-width: 80%; margin: 0 auto; }
  .tabs { margin-bottom: 20px; margin-top: 10%; display: flex; justify-content: space-evenly; align-items: center; }

  .tabs button {
    box-shadow: 2px 0 5px 0 rgba(0, 0, 0, 0.1);
    border: none; padding: 10px 15px; border-radius: 10px;
    cursor: pointer; transition: 0.3s; font-weight: 500; background: #f8f9fa;
  }

  .tabs button.active { background-color: #28a745 !important; color: white !important; }

  /* Gatilho '?' Minimalista dentro do Card */
  .form-section {
    position: relative; /* Base para o posicionamento do √≠cone */
    box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
    padding: 30px;
    border-radius: 10px;
    background: #fff;
  }

  .info-trigger {
    position: absolute;
    top: 15px;
    right: 15px;
    width: 22px;
    height: 22px;
    border: 1px solid #ddd;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    color: #999;
    cursor: pointer;
    transition: 0.2s;
    font-weight: bold;
  }

  .info-trigger:hover {
    color: #28a745;
    border-color: #28a745;
    background: #f0fff4;
  }

  /* Modal (Estrutura Original com corre√ß√£o de exibi√ß√£o) */
  .modal {
    position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%;
    background-color: rgba(52, 52, 52, 0.71); display: none; justify-content: center; align-items: center;
    backdrop-filter: blur(2px);
  }

/* No seu bloco extra_css */

.modal-content h3 {
  margin-top: 0;
  color: #28a745;
  padding-right: 20px; /* Evita sobrepor o 'X' */
}

.modal-content p {
  color: #2f2f2fff;
  line-height: 1.5;
}

.curiosity-box strong {
  color: #007bff;
  display: block;
  margin-bottom: 5px;
}

.curiosity-box p {
  margin: 0;
  font-size: 0.9em;
  font-style: italic;
}

  @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

  .close-modal { position: absolute; right: 15px; top: 10px; font-size: 24px; cursor: pointer; color: #888; }
  .curiosity-box { margin-top: 15px; padding: 10px; background-color: #e7f3ff; border-left: 4px solid #007bff; border-radius: 4px; }
  .hidden { display: none !important; }

  /* Estilos de Formul√°rio (Mantidos) */
  .form-section h2 { text-align: center; margin-bottom: 20px; }
  .form-group { margin-bottom: 12px; }
  .form-group label { display: block; margin-bottom: 4px; font-weight: 500; }
  .form-section input { padding: 8px; width: 100%; border: 1px solid #ccc; border-radius: 4px; }
  .form-section input:focus { outline: none; border-color: #28a745; box-shadow: 0 0 5px rgba(40, 167, 69, 0.3); }
</style>
{% endblock %}